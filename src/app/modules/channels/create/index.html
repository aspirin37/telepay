<div class="container py-3">
    <h2 class="text-secondary my-4">Новый канал
        <router-link tag="small"
            :to="{name:'channels:list'}"
            class="float-right pointer">
            <i class="fa fa-lg fa-chevron-left"></i> Назад</router-link>
    </h2>
    <div class="row mt-4"
        v-if="channel">
        <div class="col-2 ">
            <avatar :src="'/images/channels/'+channel.telegram_id+'_'+channel.photo_id+'.jpg'"
                style="max-width: 200px; max-height: 200px;"
                :circle="true" />
        </div>
        <div class="col-6">
            <h4>{{channel.title}}
                <small v-if="channel.telegram_id">подписчиков: {{channel.subscriber_count | cutKilo}}</small>
            </h4>
            <p>Подтвержден: {{channel.is_confirmed?'Да':'Нет'}}</p>
            <p v-html="$options.filters.parseLinks(channel.description,'Нет описания')"></p>
        </div>
        <div class="col-4">
            Автопостинг
            <on-off v-model="channel.autopost" />
        </div>
    </div>
    <div class="row mt-4">
        <div class="col-4">
            <div class="form-group">
                <p class="text-secondary font-weight-500 mb-1">Ссылка на канал</p>
                <input type="text"
                    class="form-control"
                    placeholder="username или t.me/username"
                    @input="getChannelInfo"
                    v-model="usernameQuery">

            </div>
        </div>
        <div class="col-4">
            <div class="form-group">
                <p class="text-secondary font-weight-500 mb-1">Категории</p>
                <search-input v-model="channel.category"
                    :search-action="(q)=>q"
                    placeholder="Категории"
                    :options="categories" />
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-8">
            <p class="form-text">
                <span v-show="!isLoading && searchError"
                    class="text-danger">Такого канала нет :(</span>
                <span class="text-muted"
                    v-show="isLoading">Ищем канал...</span>
                <span class="text-muted"
                    v-show="channel.telegram_id && !isLoading && !searchError && !channel.is_confirmed">Чтобы привязать канал к сервису вам необходимо добавить
                    <a href="https://t.me/telepayDevBot">нашего бота</a> в канал и дать ему права админа на постинг</span>
                &nbsp;
            </p>
        </div>
    </div>
    <div class="row">
        <div class="col-2">
            <button class="btn btn-success"
                :disabled="!channel.telegram_id || !channel.is_confirmed"
                @click="add">Добавить канал</button>
        </div>
    </div>

</div>